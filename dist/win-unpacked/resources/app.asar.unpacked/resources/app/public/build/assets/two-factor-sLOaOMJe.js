import{b as D,r as l,u as o,j as e,H as F}from"./app-BndNHLne.js";import{S as E,H}from"./layout-BYd9v7Mz.js";import{I as L}from"./input-error-E2jT0cFq.js";import{a as k,B as a}from"./button-B938siKt.js";import{I as M}from"./input-7eto-rc8.js";import{L as B}from"./label-CIW_vp9F.js";import{C as u,a as m,b as p,c as x,d as g}from"./card-BXOJrilN.js";import{A as h,a as j}from"./alert-BP3I-Ifl.js";import{A as P}from"./app-layout-Bta0KnNJ.js";import{K as n}from"./key-Dji0Y-Nj.js";import{C as b}from"./circle-check-big-6HIQxMB4.js";/* empty css            */import"./separator-DOf9pYrm.js";import"./index-DI4Ye8VL.js";import"./app-header-layout-DF_mBwyX.js";import"./index-QVslWZ3W.js";import"./app-logo-icon-Dajt3FdR.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],i=k("Copy",q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],v=k("TriangleAlert",K),V=[{title:"Autenticación de 2 Factores",href:"/settings/two-factor"}];function me({two_factor_enabled:O,two_factor_confirmed:$,two_factor_setup:J,recovery_codes:t}){const{flash:s,errors:Q}=D().props,[_,C]=l.useState(!1),[A,y]=l.useState(!1),[w,N]=l.useState(null);o({}),o({code:""}),o({password:""});const{data:S,setData:R,post:T,processing:f,errors:G,reset:I}=o({password:""});o({password:""});const z=r=>{r.preventDefault(),T(route("two-factor.recovery-codes"),{preserveScroll:!0,onSuccess:()=>{I(),C(!0)}})},c=r=>{navigator.clipboard.writeText(r),N(r),setTimeout(()=>N(null),2e3)};return e.jsxs(P,{breadcrumbs:V,children:[e.jsx(F,{title:"Autenticación de 2 Factores"}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(H,{title:"Códigos de Recuperación",description:"Agrega una capa adicional de seguridad a tu cuenta"}),e.jsxs(u,{children:[e.jsxs(m,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"Gestionar Códigos de Recuperación"]}),e.jsx(x,{children:"Ver códigos actuales o generar nuevos códigos de recuperación"})]}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:e.jsx("form",{onSubmit:z,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"recovery_password",children:"Generar Nuevos Códigos"}),e.jsx(M,{id:"recovery_password",type:"password",placeholder:"Contraseña actual",value:S.password,onChange:r=>R("password",r.target.value),required:!0}),e.jsx(L,{message:G.password,className:"mt-2"})]}),e.jsx(a,{type:"submit",disabled:f,className:"w-full",children:f?"Generando...":"Generar Nuevos"})]})})}),e.jsxs(h,{children:[e.jsx(v,{className:"h-4 w-4"}),e.jsxs(j,{children:[e.jsx("strong",{children:"Importante:"})," Generar nuevos códigos invalidará todos los códigos anteriores."]})]})]})})]}),t&&t.length>0&&e.jsxs(u,{children:[e.jsxs(m,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"Tus Códigos de Recuperación Actuales"]}),e.jsx(x,{children:"Estos son tus códigos de recuperación de emergencia. Guárdalos en un lugar seguro."})]}),e.jsxs(g,{children:[e.jsxs(h,{className:"mb-4",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsxs(j,{children:[e.jsx("strong",{children:"Importante:"})," Cada código solo se puede usar una vez. Guárdalos en un lugar seguro."]})]}),A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-muted rounded-lg font-mono text-sm",children:t.map((r,d)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-background rounded border",children:[e.jsx("span",{children:r}),e.jsx(a,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(r),children:w===r?e.jsx(b,{className:"h-4 w-4"}):e.jsx(i,{className:"h-4 w-4"})})]},d))}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs(a,{type:"button",variant:"outline",onClick:()=>{const r=t.join(`
`);c(r)},children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),"Copiar Todos"]}),e.jsx(a,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Ocultar Códigos"})]})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-lg font-mono text-muted-foreground",children:"••••-•••• ••••-•••• ••••-•••• ••••-••••"}),e.jsx("div",{className:"text-lg font-mono text-muted-foreground",children:"••••-•••• ••••-•••• ••••-•••• ••••-••••"})]}),e.jsxs(a,{type:"button",onClick:()=>y(!0),className:"gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),"Mostrar Códigos de Recuperación"]})]})]})]}),((s==null?void 0:s.recovery_codes)||_&&((s==null?void 0:s.status)==="recovery-codes-generated"||(s==null?void 0:s.status)==="recovery-codes-shown"||(s==null?void 0:s.status)==="two-factor-confirmed"))&&e.jsxs(u,{children:[e.jsxs(m,{children:[e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5"}),"Códigos de Recuperación"]}),e.jsx(x,{children:"Guarda estos códigos en un lugar seguro. Cada código solo se puede usar una vez."})]}),e.jsxs(g,{children:[e.jsxs(h,{className:"mb-4",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsxs(j,{children:[e.jsx("strong",{children:"Importante:"})," Guarda estos códigos en un lugar seguro. Si pierdes el acceso a tu dispositivo de autenticación, estos códigos son la única forma de acceder a tu cuenta."]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-muted rounded-lg font-mono text-sm",children:((s==null?void 0:s.recovery_codes)||[]).map((r,d)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-background rounded border",children:[e.jsx("span",{children:r}),e.jsx(a,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(r),children:w===r?e.jsx(b,{className:"h-3 w-3"}):e.jsx(i,{className:"h-3 w-3"})})]},d))}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs(a,{type:"button",variant:"outline",onClick:()=>{const r=((s==null?void 0:s.recovery_codes)||[]).join(`
`);c(r)},children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),"Copiar Todos"]}),e.jsx(a,{type:"button",variant:"outline",onClick:()=>C(!1),children:"Cerrar"})]})]})]})]})})]})}export{me as default};
