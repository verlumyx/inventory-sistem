import{u as F,j as e,H,L as N}from"./app-CDQDU1-Z.js";import{A as q,C as p,a as v,b as f,c as b,d as u}from"./card-BPvXLcXN.js";import{B as n}from"./app-logo-icon-DBxQkU93.js";import{I as y}from"./input-CBJR-IoQ.js";import{L as o}from"./label-aYMTjt1p.js";import{T as R}from"./textarea-LuGZ0fmc.js";import{S as C,a as _,b as w,c as S,d as A}from"./select-Cc2WnPwZ.js";import{A as k,a as I,T as $}from"./alert-J0thpVxT.js";import{A as M}from"./arrow-left-BSw41cGU.js";import{C as x}from"./circle-alert-ySlm1kgY.js";import{P as D}from"./plus-C8NLMfhi.js";import{P as U}from"./app-sidebar-layout-CmHeVIkJ.js";/* empty css            */import"./index-BLfVfbLY.js";import"./index-ZzJkojRU.js";import"./index-BeVMLVQb.js";function ne({items:d,warehouses:c}){const{data:i,setData:m,post:z,processing:j,errors:l}=F({name:"",description:"",status:0,items:[]}),E=s=>{s.preventDefault(),z(route("entries.store"))},g=()=>{const s={item_id:0,warehouse_id:0,amount:1};m("items",[...i.items,s])},T=s=>{const t=i.items.filter((r,a)=>a!==s);m("items",t)},h=(s,t,r)=>{const a=[...i.items];a[s]={...a[s],[t]:r},m("items",a)},L=s=>d.find(t=>t.id===s),P=s=>c.find(t=>t.id===s),V=s=>i.items.some(t=>t.item_id===s),B=()=>{const s=i.items.length>0&&i.items.every(t=>t.item_id>0&&t.warehouse_id>0&&t.amount>0);return i.name.trim()!==""&&s};return e.jsxs(q,{children:[e.jsx(H,{title:"Nueva Entrada"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{href:route("entries.index"),children:e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Nueva Entrada"}),e.jsx("p",{className:"text-muted-foreground",children:"Crea una nueva entrada de inventario con sus items"})]})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs(p,{children:[e.jsxs(v,{children:[e.jsx(f,{children:"Información Básica"}),e.jsx(b,{children:"Datos generales de la entrada"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",children:"Nombre *"}),e.jsx(y,{id:"name",type:"text",value:i.name,onChange:s=>m("name",s.target.value),placeholder:"Nombre de la entrada",className:l.name?"border-red-500":"",required:!0}),l.name&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(x,{className:"h-4 w-4"}),l.name]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Nombre descriptivo de la entrada (requerido, máximo 255 caracteres)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",children:"Descripción"}),e.jsx(R,{id:"description",value:i.description,onChange:s=>m("description",s.target.value),placeholder:"Descripción opcional de la entrada",rows:4,className:l.description?"border-red-500":""}),l.description&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(x,{className:"h-4 w-4"}),l.description]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Descripción detallada de la entrada (opcional)"})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Código Automático"}),e.jsx("div",{className:"mt-1 text-sm text-blue-700 dark:text-blue-300",children:"El código del almacén se generará automáticamente con el formato ET-00000001"})]})]})})]})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(f,{children:"Items de la Entrada"}),e.jsx(b,{children:"Agrega los items que forman parte de esta entrada"})]}),e.jsxs(n,{type:"button",variant:"outline",size:"sm",onClick:g,disabled:d.length===0||c.length===0,children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Agregar Item"]})]})}),e.jsxs(u,{className:"space-y-4",children:[d.length===0&&e.jsxs(k,{children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx(I,{children:"No hay items disponibles. Crea algunos items primero."})]}),c.length===0&&e.jsxs(k,{children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx(I,{children:"No hay almacenes disponibles. Crea algunos almacenes primero."})]}),i.items.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx(U,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:"No hay items"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Agrega items a esta entrada para comenzar"}),d.length>0&&c.length>0&&e.jsxs(n,{type:"button",variant:"outline",className:"mt-4",onClick:g,children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Agregar Primer Item"]})]}):e.jsx("div",{className:"space-y-4",children:i.items.map((s,t)=>{const r=L(s.item_id);return P(s.warehouse_id),e.jsx(p,{className:"border-l-4 border-l-blue-500",children:e.jsx(u,{className:"pt-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Item *"}),e.jsxs(C,{value:s.item_id>0?s.item_id.toString():"",onValueChange:a=>h(t,"item_id",parseInt(a)),children:[e.jsx(_,{children:e.jsx(w,{placeholder:"Seleccionar item"})}),e.jsx(S,{children:d.filter(a=>a.id===s.item_id||!V(a.id)).map(a=>e.jsx(A,{value:a.id.toString(),children:a.display_name},a.id))})]}),r&&e.jsxs("p",{className:"text-xs text-gray-500",children:[r.unit&&`Unidad: ${r.unit}`,r.price&&` • Precio: $${r.price}`]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Almacén *"}),e.jsxs(C,{value:s.warehouse_id>0?s.warehouse_id.toString():"",onValueChange:a=>h(t,"warehouse_id",parseInt(a)),children:[e.jsx(_,{children:e.jsx(w,{placeholder:"Seleccionar almacén"})}),e.jsx(S,{children:c.map(a=>e.jsx(A,{value:a.id.toString(),children:a.display_name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Cantidad *"}),e.jsx(y,{type:"number",min:"0.01",step:"0.01",value:s.amount,onChange:a=>h(t,"amount",parseFloat(a.target.value)||0),placeholder:"0.00"}),(r==null?void 0:r.unit)&&e.jsxs("p",{className:"text-xs text-gray-500",children:["en ",r.unit]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>T(t),className:"text-red-600 hover:text-red-700",children:e.jsx($,{className:"h-4 w-4"})})})]})})},t)})}),l.items&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(x,{className:"h-4 w-4"}),l.items]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(N,{href:route("entries.index"),children:e.jsx(n,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsx(n,{type:"submit",disabled:j||!B(),children:j?"Creando...":"Crear Entrada"})]})]})]})]})}export{ne as default};
