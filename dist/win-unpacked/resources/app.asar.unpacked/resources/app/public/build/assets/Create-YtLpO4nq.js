import{u as $,r as f,j as e,H as W,L as F}from"./app-Doa1X8LG.js";import{A as ee}from"./authenticated-layout-zkXyR4IY.js";import{B as c}from"./button-D4rUH4JB.js";import{I as B}from"./input-Dc5R9TS5.js";import{L as m}from"./label-HbfnK1lI.js";import{T as se}from"./textarea-CC5ZfQwb.js";import{C as y,a as C,b as I,c as H,d as w}from"./card-DF370HhO.js";import{P as L,S as P,a as V,b as z,c as R,d as q}from"./select-ZapHPyF4.js";import{A as g,a as N}from"./alert-zFhh9Z1D.js";import{T as ae,a as re,b as M,c as v,d as te,e as b}from"./table-DBCaEuI0.js";import{A as ie}from"./arrow-left-DUbe0Jwt.js";import{C as d}from"./circle-alert-B5xY-sIk.js";import{P as G}from"./app-header-layout-DeCsVdE4.js";import{T as le}from"./trash-2-DTPMTCxV.js";/* empty css            */import"./index-Cxkacx_1.js";import"./index-CUR25A5V.js";import"./check-DpiK8D10.js";import"./app-logo-icon-CJVXHink.js";function Se({items:o,warehouses:x,defaultWarehouse:n}){var k;const{data:t,setData:h,post:J,processing:S,errors:l}=$({name:"",description:"",status:0,items:[]}),K=s=>{s.preventDefault(),J(route("entries.store"))},[j,A]=f.useState(""),[p,_]=f.useState(((k=n==null?void 0:n.id)==null?void 0:k.toString())||""),[u,T]=f.useState(""),O=()=>{var E;if(!j||!p||!u)return;const s=parseInt(j),a=parseInt(p),r=parseFloat(u);if(t.items.some(D=>D.item_id===s&&D.warehouse_id===a)){alert("Este item ya está agregado en este almacén");return}const i={item_id:s,warehouse_id:a,amount:r};h("items",[...t.items,i]),A(""),_(((E=n==null?void 0:n.id)==null?void 0:E.toString())||""),T("")},Q=s=>{const a=t.items.filter((r,i)=>i!==s);h("items",a)},U=s=>o.find(a=>a.id===s),X=s=>x.find(a=>a.id===s),Y=()=>{const s=t.items.length>0&&t.items.every(a=>a.item_id>0&&a.warehouse_id>0&&a.amount>0);return t.name.trim()!==""&&s},Z=[{title:"Panel de Control",href:"/dashboard"},{title:"Entradas",href:"/entries"},{title:"Crear Entrada",href:"/entries/create"}];return e.jsxs(ee,{breadcrumbs:Z,children:[e.jsx(W,{title:"Nueva Entrada"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Crear nuevo entrada"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Crea una nueva entrada de inventario con sus items"})]}),e.jsx(F,{href:"/entries",children:e.jsxs(c,{variant:"outline",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Volver"]})})]}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs(y,{children:[e.jsxs(C,{children:[e.jsx(I,{children:"Información Básica"}),e.jsx(H,{children:"Datos generales de la entrada"})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Nombre *"}),e.jsx(B,{id:"name",type:"text",value:t.name,onChange:s=>h("name",s.target.value),placeholder:"Nombre de la entrada",className:l.name?"border-red-500":"",required:!0}),l.name&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(d,{className:"h-4 w-4"}),l.name]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Nombre descriptivo de la entrada (requerido, máximo 255 caracteres)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Descripción"}),e.jsx(se,{id:"description",value:t.description,onChange:s=>h("description",s.target.value),placeholder:"Descripción opcional de la entrada",rows:4,className:l.description?"border-red-500":""}),l.description&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(d,{className:"h-4 w-4"}),l.description]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Descripción detallada de la entrada (opcional)"})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Código Automático"}),e.jsx("div",{className:"mt-1 text-sm text-blue-700 dark:text-blue-300",children:"El código del almacén se generará automáticamente con el formato ET-00000001"})]})]})})]})]}),e.jsxs(y,{children:[e.jsxs(C,{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Agregar Items"]}),e.jsx(H,{children:"Agrega items a la entrada de forma rápida y dinámica"})]}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"item_select",children:"Item"}),e.jsxs(P,{value:j,onValueChange:A,children:[e.jsx(V,{children:e.jsx(z,{placeholder:"Seleccionar item"})}),e.jsx(R,{children:o.map(s=>e.jsx(q,{value:s.id.toString(),children:s.display_name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"warehouse_select",children:"Almacén"}),e.jsxs(P,{value:p,onValueChange:_,children:[e.jsx(V,{children:e.jsx(z,{placeholder:"Seleccionar almacén"})}),e.jsx(R,{children:x.map(s=>e.jsx(q,{value:s.id.toString(),children:s.display_name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"amount",children:"Cantidad"}),e.jsx(B,{id:"amount",type:"number",step:"0.01",min:"0.01",placeholder:"0.00",value:u,onChange:s=>T(s.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(c,{type:"button",onClick:O,disabled:!j||!p||!u,className:"w-full",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Agregar"]})})]})})]}),e.jsxs(y,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Items de la Entrada (",t.items.length,")"]})}),e.jsxs(w,{children:[o.length===0&&e.jsxs(g,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(N,{children:"No hay items disponibles. Crea algunos items primero."})]}),x.length===0&&e.jsxs(g,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(N,{children:"No hay almacenes disponibles. Crea algunos almacenes primero."})]}),t.items.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(G,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay items agregados"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Agrega items usando el formulario de arriba"})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(ae,{children:[e.jsx(re,{children:e.jsxs(M,{children:[e.jsx(v,{children:"Item"}),e.jsx(v,{children:"Almacén"}),e.jsx(v,{className:"text-right",children:"Cantidad"}),e.jsx(v,{className:"w-[100px]",children:"Acciones"})]})}),e.jsx(te,{children:t.items.map((s,a)=>{const r=U(s.item_id),i=X(s.warehouse_id);return e.jsxs(M,{children:[e.jsx(b,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r==null?void 0:r.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[r==null?void 0:r.code," • ",r==null?void 0:r.unit]})]})}),e.jsx(b,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i==null?void 0:i.name}),e.jsx("div",{className:"text-sm text-gray-500",children:i==null?void 0:i.code})]})}),e.jsx(b,{className:"text-right",children:Number(s.amount).toFixed(2)}),e.jsx(b,{children:e.jsx(c,{type:"button",variant:"ghost",size:"sm",onClick:()=>Q(a),children:e.jsx(le,{className:"h-4 w-4 text-red-500"})})})]},a)})})]})}),l.items&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:l.items})]})]}),o.length===0&&e.jsxs(g,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(N,{children:"No hay items disponibles. Crea algunos items primero."})]}),x.length===0&&e.jsxs(g,{children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx(N,{children:"No hay almacenes disponibles. Crea algunos almacenes primero."})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(F,{href:route("entries.index"),children:e.jsx(c,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsx(c,{type:"submit",disabled:S||!Y(),children:S?"Creando...":"Crear Entrada"})]})]})]})]})}export{Se as default};
