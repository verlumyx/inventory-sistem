import{u as $,r as q,j as e,H as B,L as v}from"./app-CDQDU1-Z.js";import{A as H,C as j,a as b,b as y,c as w,d as u}from"./card-BPvXLcXN.js";import{a as R,B as m}from"./app-logo-icon-DBxQkU93.js";import{I as g}from"./input-CBJR-IoQ.js";import{L as l}from"./label-aYMTjt1p.js";import{T as U}from"./textarea-LuGZ0fmc.js";import{S as _,a as C,b as S,c as A,d as E}from"./select-Cc2WnPwZ.js";import{A as L,a as k,T as W}from"./alert-J0thpVxT.js";import{A as G}from"./arrow-left-BSw41cGU.js";import{C as h}from"./circle-alert-ySlm1kgY.js";import{P as D}from"./plus-C8NLMfhi.js";import{P as J}from"./app-sidebar-layout-CmHeVIkJ.js";/* empty css            */import"./index-BLfVfbLY.js";import"./index-ZzJkojRU.js";import"./index-BeVMLVQb.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],O=R("Lock",K);function xe({entry:r,items:o,warehouses:x}){const{data:d,setData:n,put:I,processing:N,errors:c}=$({name:r.name,description:r.description||"",status:r.status,items:[]});q.useEffect(()=>{const s=r.items.map(t=>({id:t.id,item_id:t.item_id,warehouse_id:t.warehouse_id,amount:t.amount,item:t.item,warehouse:t.warehouse}));n("items",s)},[r.items]);const z=s=>{s.preventDefault(),I(route("entries.update",r.id))},f=()=>{const s={item_id:0,warehouse_id:0,amount:1};n("items",[...d.items,s])},F=s=>{const t=d.items.filter((i,a)=>a!==s);n("items",t)},p=(s,t,i)=>{const a=[...d.items];a[s]={...a[s],[t]:i},n("items",a)},P=s=>o.find(t=>t.id===s),T=s=>x.find(t=>t.id===s),V=(s,t)=>d.items.some((i,a)=>i.item_id===s&&a!==t),M=()=>d.name.trim()!==""&&d.items.length>0&&d.items.every(s=>s.item_id>0&&s.warehouse_id>0&&s.amount>0);return e.jsxs(H,{children:[e.jsx(B,{title:`Editar Entrada - ${r.code}`}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(v,{href:route("entries.index"),children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Editar Entrada"}),e.jsxs("p",{className:"text-muted-foreground",children:["Modifica la entrada ",r.code," y sus items"]})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs(j,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Información Básica"}),e.jsx(w,{children:"Datos generales de la entrada"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"code",children:"Código"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"code",type:"text",value:r.code,disabled:!0,className:"bg-gray-50"}),e.jsx(O,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"El código de la entrada no se puede modificar"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Nombre *"}),e.jsx(g,{id:"name",type:"text",value:d.name,onChange:s=>n("name",s.target.value),placeholder:"Nombre de la entrada",className:c.name?"border-red-500":"",required:!0}),c.name&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(h,{className:"h-4 w-4"}),c.name]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Nombre descriptivo de la entrada (requerido, máximo 255 caracteres)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"description",children:"Descripción"}),e.jsx(U,{id:"description",value:d.description,onChange:s=>n("description",s.target.value),placeholder:"Descripción opcional de la entrada",rows:4,className:c.description?"border-red-500":""}),c.description&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(h,{className:"h-4 w-4"}),c.description]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Descripción detallada de la entrada (opcional)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-500",children:"Fecha de Creación"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(r.created_at).toLocaleString("es-ES")})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-500",children:"Última Modificación"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(r.updated_at).toLocaleString("es-ES")})]})]})]})]}),e.jsxs(j,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(y,{children:"Items de la Entrada"}),e.jsx(w,{children:"Modifica los items que forman parte de esta entrada"})]}),e.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:f,disabled:o.length===0||x.length===0,children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Agregar Item"]})]})}),e.jsxs(u,{className:"space-y-4",children:[o.length===0&&e.jsxs(L,{children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(k,{children:"No hay items disponibles. Crea algunos items primero."})]}),x.length===0&&e.jsxs(L,{children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(k,{children:"No hay almacenes disponibles. Crea algunos almacenes primero."})]}),d.items.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx(J,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:"No hay items"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Agrega items a esta entrada para comenzar"}),o.length>0&&x.length>0&&e.jsxs(m,{type:"button",variant:"outline",className:"mt-4",onClick:f,children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Agregar Primer Item"]})]}):e.jsx("div",{className:"space-y-4",children:d.items.map((s,t)=>{const i=P(s.item_id)||s.item;return T(s.warehouse_id)||s.warehouse,e.jsx(j,{className:"border-l-4 border-l-blue-500",children:e.jsx(u,{className:"pt-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Item *"}),e.jsxs(_,{value:s.item_id>0?s.item_id.toString():"",onValueChange:a=>p(t,"item_id",parseInt(a)),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Seleccionar item"})}),e.jsx(A,{children:o.filter(a=>a.id===s.item_id||!V(a.id,t)).map(a=>e.jsx(E,{value:a.id.toString(),children:a.display_name},a.id))})]}),i&&e.jsxs("p",{className:"text-xs text-gray-500",children:[i.unit&&`Unidad: ${i.unit}`,i.price&&` • Precio: $${i.price}`]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Almacén *"}),e.jsxs(_,{value:s.warehouse_id>0?s.warehouse_id.toString():"",onValueChange:a=>p(t,"warehouse_id",parseInt(a)),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Seleccionar almacén"})}),e.jsx(A,{children:x.map(a=>e.jsx(E,{value:a.id.toString(),children:a.display_name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Cantidad *"}),e.jsx(g,{type:"number",min:"0.01",step:"0.01",value:s.amount,onChange:a=>p(t,"amount",parseFloat(a.target.value)||0),placeholder:"0.00"}),(i==null?void 0:i.unit)&&e.jsxs("p",{className:"text-xs text-gray-500",children:["en ",i.unit]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:()=>F(t),className:"text-red-600 hover:text-red-700",children:e.jsx(W,{className:"h-4 w-4"})})})]})})},t)})}),c.items&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(h,{className:"h-4 w-4"}),c.items]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(v,{href:route("entries.show",r.id),children:e.jsx(m,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsx(m,{type:"submit",disabled:N||!M(),children:N?"Actualizando...":"Actualizar Entrada"})]})]})]})]})}export{xe as default};
